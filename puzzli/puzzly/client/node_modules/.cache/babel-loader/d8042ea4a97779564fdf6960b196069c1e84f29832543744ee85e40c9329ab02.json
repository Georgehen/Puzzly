{"ast":null,"code":"var _jsxFileName = \"/home/tor/puzzli/puzzly/client/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport { Chess } from 'chess.js';\nimport Navbar from './components/NavBar';\nimport UserInput from './components/UserInput';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [username, setUsername] = useState('Mahlloch');\n  const [blunderPositions, setBlunderPositions] = useState([]); // To store FENs\n\n  const generate = async () => {\n    try {\n      const localResp = await axios.get(`http://localhost:5000/api/tactics/${username}`);\n      if (localResp.data.length === 0) {\n        const response = await axios.get(`https://lichess.org/api/games/user/${username}?max=200&analysed=true&evals=true&moves=true&pgnInJson=true&perfType=blitz,rapid,classical`, {\n          headers: {\n            'Accept': 'application/x-ndjson'\n          }\n        });\n        const games = response.data.split('\\n').filter(x => x).map(x => JSON.parse(x));\n        const blunders = findBlunders(games, username);\n        setBlunderPositions(blunders);\n      } else {\n        setBlunderPositions(localResp.data); // Use the locally stored tactics if available\n      }\n    } catch (error) {\n      console.error('Error fetching tactics:', error);\n    }\n  };\n  function findBlunders(games, username) {\n    let blunderFENs = [];\n    games.forEach(game => {\n      // Determine which color the user is playing\n      const moves = game.moves;\n      const players = game.players;\n      const userColor = players.white.user.name === username ? 'white' : 'black';\n      const analysis = game.analysis;\n      const moveList = moves.split(' ');\n      console.log(moveList);\n      const chess = new Chess();\n      let idx = 0;\n\n      // Process each move\n      moveList.forEach(move => {\n        // Check if the current move is a blunder by the user\n        if (analysis[idx] && analysis[idx].judgment && analysis[idx].judgment.name === 'Blunder') {\n          const currentPlayer = idx % 2 === 0 ? 'white' : 'black';\n\n          // Check if the blunder was made by the user\n          if (currentPlayer === userColor) {\n            // Undo the blunder move to get the position before the move\n            // Add the FEN of the position before the blunder\n            blunderFENs.push(chess.fen());\n          }\n        }\n        chess.move(move);\n        idx++;\n      });\n    });\n    return blunderFENs;\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"app\",\n    children: /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"hero is-fullheight\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"hero-head\",\n        children: /*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"hero-body\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: [/*#__PURE__*/_jsxDEV(UserInput, {\n            username: username,\n            setUsername: setUsername,\n            generate: generate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"has-text-centered\",\n            children: \"Enter your Lichess username to generate your tactics based on blunders.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 25\n          }, this), blunderPositions.map((fen, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"button is-link is-outlined is-fullwidth mb-2\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              href: `https://lichess.org/analysis/fromPosition/${encodeURIComponent(fen)}`,\n              target: \"_blank\",\n              rel: \"noopener noreferrer\",\n              children: [\"Analyze FEN before blunder \", index + 1]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 33\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 29\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 9\n  }, this);\n}\n_s(App, \"4xVBPB1nspCSOgY4D8gv68d/s8I=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","axios","Chess","Navbar","UserInput","jsxDEV","_jsxDEV","App","_s","username","setUsername","blunderPositions","setBlunderPositions","generate","localResp","get","data","length","response","headers","games","split","filter","x","map","JSON","parse","blunders","findBlunders","error","console","blunderFENs","forEach","game","moves","players","userColor","white","user","name","analysis","moveList","log","chess","idx","move","judgment","currentPlayer","push","fen","id","children","className","fileName","_jsxFileName","lineNumber","columnNumber","index","href","encodeURIComponent","target","rel","_c","$RefreshReg$"],"sources":["/home/tor/puzzli/puzzly/client/src/App.js"],"sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\nimport { Chess } from 'chess.js';\nimport Navbar from './components/NavBar';\nimport UserInput from './components/UserInput';\n\nfunction App() {\n    const [username, setUsername] = useState('Mahlloch');\n    const [blunderPositions, setBlunderPositions] = useState([]); // To store FENs\n\n   const generate = async () => {\n        try {\n            const localResp = await axios.get(`http://localhost:5000/api/tactics/${username}`);\n            if (localResp.data.length === 0) {\n                const response = await axios.get(`https://lichess.org/api/games/user/${username}?max=200&analysed=true&evals=true&moves=true&pgnInJson=true&perfType=blitz,rapid,classical`, {\n                    headers: { 'Accept': 'application/x-ndjson' }\n                });\n                const games = response.data.split('\\n').filter(x => x).map(x => JSON.parse(x));\n                const blunders = findBlunders(games, username);\n                setBlunderPositions(blunders);\n            } else {\n                setBlunderPositions(localResp.data); // Use the locally stored tactics if available\n            }\n        } catch (error) {\n            console.error('Error fetching tactics:', error);\n        }\n    };\n\n    function findBlunders(games, username) {\n      let blunderFENs = [];\n\n      games.forEach((game) => {\n\n        // Determine which color the user is playing\n        const moves = game.moves;\n        const players = game.players;\n        const userColor = players.white.user.name === username ? 'white' : 'black';\n        const analysis = game.analysis;\n        const moveList = moves.split(' ');\n        console.log(moveList);\n        const chess = new Chess();\n\n        let idx = 0;\n\n\n        // Process each move\n        moveList.forEach((move) => {\n          // Check if the current move is a blunder by the user\n          if (analysis[idx] && analysis[idx].judgment && analysis[idx].judgment.name === 'Blunder') {\n            const currentPlayer = idx % 2 === 0 ? 'white' : 'black';\n\n            // Check if the blunder was made by the user\n            if (currentPlayer === userColor) {\n\n              // Undo the blunder move to get the position before the move\n              // Add the FEN of the position before the blunder\n              blunderFENs.push(chess.fen());\n            }\n          }\n          chess.move(move);\n          idx++;\n        });\n      });\n\n      return blunderFENs;\n    }\n\n\n\n    return (\n        <div id=\"app\">\n            <section className=\"hero is-fullheight\">\n                <div className=\"hero-head\">\n                    <Navbar />\n                </div>\n                <div className=\"hero-body\">\n                    <div className=\"container\">\n                        <UserInput\n                            username={username}\n                            setUsername={setUsername}\n                            generate={generate}\n                        />\n                        <div className=\"has-text-centered\">\n                            Enter your Lichess username to generate your tactics based on blunders.\n                        </div>\n                        <br />\n                        {blunderPositions.map((fen, index) => (\n                            <div key={index} className=\"button is-link is-outlined is-fullwidth mb-2\">\n                                <a href={`https://lichess.org/analysis/fromPosition/${encodeURIComponent(fen)}`} target=\"_blank\" rel=\"noopener noreferrer\">\n                                    Analyze FEN before blunder {index + 1}\n                                </a>\n                            </div>\n                        ))}\n                    </div>\n                </div>\n            </section>\n        </div>\n    );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}